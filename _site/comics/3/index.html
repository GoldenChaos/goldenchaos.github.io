<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-317947-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'UA-317947-1');
    </script>
    <meta charset="utf-8">
    <title>GoldenChaos Comics - #3 Yuri Mustache</title>
    <meta name="description" content="Comics by Jess Rappaport!">

        
        
            
        

        
        
            
        

        <!-- Facebook / Open Graph -->
        <meta property="og:url" content="https://goldenchaos.net/comics/3/">
        <meta property="og:type" content="website">
        <meta property="og:title" content="GoldenChaos Comics - #3 Yuri Mustache">
        <meta property="og:description" content="Comics by Jess Rappaport!">
        <meta property="og:image" content="https://goldenchaos.net/images/comics/3_yuri_mustache.png">
        <meta property="og:image:alt" content="Comics by Jess Rappaport!">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta property="twitter:domain" content="goldenchaos.net">
    <meta property="twitter:url" content="https://goldenchaos.net/comics/3/">
    <meta name="twitter:title" content="GoldenChaos Comics - #3 Yuri Mustache">
    <meta name="twitter:description" content="Comics by Jess Rappaport!">
    <meta name="twitter:site" content="@GoldenChaos">
    <meta name="twitter:creator" content="@GoldenChaos">
    <meta name="twitter:image" content="https://goldenchaos.net/images/comics/og/3_yuri_mustache-og.png">
    <meta name="twitter:image:alt" content="Comics by Jess Rappaport!">
        <link rel="alternate" type="application/rss+xml" title="GoldenChaos Comics RSS" href="/comics/feed.xml">

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="Jess Rappaport">
    <link rel="stylesheet" type="text/css" href="/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <script src="https://kit.fontawesome.com/ede7ed9b9e.js" crossorigin="anonymous"></script>
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="/apple-touch-icon-precomposed.png">
    <link rel="mask-icon" href="/website_icon.svg" color="#4083a0">
        <link rel="manifest" href="/manifest.webmanifest">
    <meta name='viewport' content='initial-scale=1, viewport-fit=cover'>
        
        <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
        <script>
            window.OneSignalDeferred = window.OneSignalDeferred || [];
            OneSignalDeferred.push(async function(OneSignal) {
                await OneSignal.init({
                    appId: "72940797-fce4-4404-92c2-a33aa17e19b3"
                });
            });
        </script>
        

</head>
<body class="">
  




  

  

  
    
  

  


  


  



<div class="page-top white goldenchaos-btt">
  <nav>
    <a id="logo" class="back-logo" href="/">
        
            <i class="fas fa-chevron-left mobile"></i>
        
    </a>
    <div class="menu">
        <div>
            
                <a class="social" href="https://twitch.tv/jessrappaport" target="_blank"><i class="fab fa-twitch"></i></a>
            
                <a class="social" href="https://discord.gg/kp3s6ysCtn" target="_blank" style="display:none;"><i class="fab fa-discord"></i></a>
            
                <a class="social" href="https://twitter.com/goldenchaos" target="_blank"><i class="fa-brands fa-x-twitter"></i></a>
            
                <a class="social" href="https://instagram.com/goldenchaos" target="_blank"><i class="fab fa-instagram"></i></a>
            
                <a class="social" href="https://threads.net/@goldenchaos" target="_blank"><i class="fa-brands fa-threads"></i></a>
            
                <a class="social" href="https://bsky.app/profile/goldenchaos.bsky.social" target="_blank"><i class="fa-brands fa-bluesky"></i></a>
            
                <a class="social" href="https://www.linkedin.com/in/goldenchaos" target="_blank"><i class="fab fa-linkedin"></i></a>
            
                <a class="social" href="mailto:jess@goldenchaos.net" target="_blank" style="display:none;"><i class="fa fa-envelope-square"></i></a>
            
        </div>
        
        <div class="desktop">
            
            
                <a href="/">
                    <i class="fas fa-chevron-left" style="font-size:14px;margin-right:3px;"></i>
                    Back to Home
                </a>
            
        </div>
        
    </div>
</nav>

</div>
<div class="content index page" id="comic-title">
  <h1 id="comics" class="title" style="text-align:center;margin:0;text-transform:none;">#3 - Yuri Mustache</h1>
</div>
<div class="content page" style="text-align:center;">
  <img src="/images/comics/3_yuri_mustache.png" alt="3 - Yuri Mustache" class="comic-img">
  <div class="segmented-control">
    <a href="/comics/1/" onclick="if(typeof gtag!=='undefined')gtag('event','comic_navigation',{'event_category':'engagement','event_label':'first'})">
      <center>
        <i class="fa-solid fa-fast-backward"></i>
        First
      </center>
    </a>
    <a href="/comics/2/" onclick="if(typeof gtag!=='undefined')gtag('event','comic_navigation',{'event_category':'engagement','event_label':'previous'})">
      <center>
        <i class="fa-solid fa-backward"></i>
        Previous
      </center>
    </a>
    <a href="/comics/all/" onclick="if(typeof gtag!=='undefined')gtag('event','comic_navigation',{'event_category':'engagement','event_label':'view_all'})">
      <center>
        <svg viewBox="0 0 30 30" xmlns="http://www.w3.org/2000/svg" style="width: 26px; height: 26px; display: block; margin: 0 auto 8px;">
          <rect x="2" y="2" width="7" height="7" rx="1.5" ry="1.5" fill="currentColor"/>
          <rect x="11" y="2" width="7" height="7" rx="1.5" ry="1.5" fill="currentColor"/>
          <rect x="20" y="2" width="7" height="7" rx="1.5" ry="1.5" fill="currentColor"/>
          <rect x="2" y="11" width="7" height="7" rx="1.5" ry="1.5" fill="currentColor"/>
          <rect x="11" y="11" width="7" height="7" rx="1.5" ry="1.5" fill="currentColor"/>
          <rect x="20" y="11" width="7" height="7" rx="1.5" ry="1.5" fill="currentColor"/>
          <rect x="2" y="20" width="7" height="7" rx="1.5" ry="1.5" fill="currentColor"/>
          <rect x="11" y="20" width="7" height="7" rx="1.5" ry="1.5" fill="currentColor"/>
          <rect x="20" y="20" width="7" height="7" rx="1.5" ry="1.5" fill="currentColor"/>
        </svg>
        View All
      </center>
    </a>
    <a href="/comics/4/" onclick="if(typeof gtag!=='undefined')gtag('event','comic_navigation',{'event_category':'engagement','event_label':'next'})">
      <center>
        <i class="fa-solid fa-forward"></i>
        Next
      </center>
    </a>
    <a href="/comics/" onclick="if(typeof gtag!=='undefined')gtag('event','comic_navigation',{'event_category':'engagement','event_label':'latest'})">
      <center>
        <i class="fa-solid fa-fast-forward"></i>
        Latest
      </center>
    </a>
  </div>
  <div class="segmented-control">
    <a id="copyBtn" onclick="copyComicLink()" style="cursor:pointer;">
      <center>
        <i class="fa-solid fa-link"></i>
        Copy Comic Link
      </center>
    </a>
    <a id="copyImgBtn" onclick="copyComicImageLink()" style="cursor:pointer;">
      <center>
        <i class="fa-solid fa-image"></i>
        Copy Comic Image Link
      </center>
    </a>
  </div>
  <div class="segmented-control" style="display:none;">
    <button id="notifyComic" class="toggle-switch">
      <i class="fa-regular fa-bell"></i>
      <span>Get notified about new comics</span>
      <div class="switch-toggle" onclick="requestNotifications('notifyComic'); event.stopPropagation();">
        <div class="switch-circle"></div>
      </div>
    </button>
  </div>
</div>
<footer>
  <span>&copy; 2004-<script>document.write(new Date().getFullYear())</script> Jess Rappaport</span>
</footer>
<script>
async function copyWithFallback(text) {
  try {
    await navigator.clipboard.writeText(text);
    return true;
  } catch (err) {
    const textarea = document.createElement('textarea');
    textarea.value = text;
    textarea.style.position = 'fixed';
    textarea.style.opacity = '0';
    document.body.appendChild(textarea);
    textarea.focus();
    textarea.select();
    let ok = false;
    try {
      ok = document.execCommand('copy');
    } catch (copyErr) {
      console.error('Copy failed', copyErr);
    }
    document.body.removeChild(textarea);
    return ok;
  }
}

function showCopied(buttonId, success) {
  const btn = document.getElementById(buttonId);
  if (!btn) return;
  const originalHTML = btn.innerHTML;
  btn.innerHTML = success ? '<center><i class="fa-solid fa-check"></i>Copied!</center>' : '<center><i class="fa-solid fa-xmark"></i>Copy failed</center>';
  setTimeout(() => {
    btn.innerHTML = originalHTML;
  }, 2000);
}

async function copyComicLink() {
  const link = window.location.origin + '/comics/3/';
  const ok = await copyWithFallback(link);
  showCopied('copyBtn', ok);
  if (ok && typeof gtag !== 'undefined') {
    gtag('event', 'copy_link', {
      'event_category': 'engagement',
      'event_label': 'comic_link'
    });
  }
}

async function copyComicImageLink() {
  const fullURL = new URL('/images/comics/3_yuri_mustache.png', window.location.origin).href;
  const ok = await copyWithFallback(fullURL);
  showCopied('copyImgBtn', ok);
  if (ok && typeof gtag !== 'undefined') {
    gtag('event', 'copy_link', {
      'event_category': 'engagement',
      'event_label': 'comic_image_link'
    });
  }
}

function updateBellIcon(buttonId, isSubscribed) {
  const btn = document.getElementById(buttonId);
  if (!btn) return;
  const bellClass = isSubscribed ? 'fa-solid' : 'fa-regular';
  const icon = btn.querySelector('i');
  if (icon) {
    icon.className = bellClass + ' fa-bell';
  }
  btn.classList.toggle('active', isSubscribed);
}

async function checkNotificationStatus(buttonId) {
  if (!window.OneSignalDeferred) return;
  OneSignalDeferred.push(async function(OneSignal) {
    const permission = await OneSignal.Notifications.permission;
    updateBellIcon(buttonId, permission);
  });
}

async function requestNotifications(buttonId) {
  const btn = document.getElementById(buttonId);
  if (!btn) return;
  if (!window.OneSignalDeferred) {
    alert('Push notifications are not available.');
    return;
  }
  
  // Optimistically toggle the switch immediately
  const wasActive = btn.classList.contains('active');
  updateBellIcon(buttonId, !wasActive);
  
  btn.disabled = true;
  OneSignalDeferred.push(async function(OneSignal) {
    try {
      const permission = await OneSignal.Notifications.permission;
      
      // If already subscribed and toggle was active, unsubscribe
      if (permission && wasActive) {
        console.log('Unsubscribing...');
        await OneSignal.User.PushSubscription.optOut();
        console.log('Unsubscribed successfully');
        updateBellIcon(buttonId, false);
        btn.disabled = false;
        return;
      }
      
      // If already subscribed but toggle was inactive, just update UI
      if (permission) {
        console.log('Already subscribed');
        btn.disabled = false;
        return;
      }
      const browserPermission = Notification.permission;
      if (browserPermission === 'denied') {
        alert('Push notifications are blocked. Please enable them in your browser settings.');
        updateBellIcon(buttonId, wasActive); // Revert toggle
        btn.disabled = false;
        return;
      }
      
      // Try optIn first (v16 native method)
      try {
        await OneSignal.User.PushSubscription.optIn();
      } catch (optInError) {
        // Fallback to Slidedown
        await OneSignal.Slidedown.promptPush();
      }
      
      const newPermission = Notification.permission;
      if (newPermission === 'granted') {
        // Wait for OneSignal to sync the subscription to their servers
        await new Promise(resolve => setTimeout(resolve, 1500));
        
        // Check if subscription is actually registered with OneSignal
        const isPushSubscribed = await OneSignal.User.PushSubscription.isPushSubscriptionEnabled();
        
        if (isPushSubscribed) {
          updateBellIcon(buttonId, true);
          // Track subscription in Google Analytics
          if (typeof gtag !== 'undefined') {
            gtag('event', 'notification_subscribe', {
              'event_category': 'engagement',
              'event_label': 'comic_notifications'
            });
          }
        } else {
          alert('Permission granted, but subscription sync failed. Please try again.');
          updateBellIcon(buttonId, wasActive); // Revert toggle
        }
      } else if (newPermission === 'denied') {
        alert('You denied push notification permission.');
        updateBellIcon(buttonId, wasActive); // Revert toggle
      } else {
        updateBellIcon(buttonId, wasActive); // Revert toggle
      }
      btn.disabled = false;
    } catch (error) {
      console.error('Notification request error:', error);
      alert('Subscription failed. Please try again.');
      updateBellIcon(buttonId, wasActive); // Revert toggle
      btn.disabled = false;
    }
  });
}

if (window.OneSignalDeferred) {
  OneSignalDeferred.push(async function(OneSignal) {
    checkNotificationStatus('notifyLatest');
  });
}
</script>

  
</body>
</html>
