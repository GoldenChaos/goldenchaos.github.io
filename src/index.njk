---
layout: layouts/base.njk
title: "GoldenChaos - UI Design and Comics by Jess Rappaport"
description: "UI Design and Comics by Jess Rappaport"
ogImage: "/og-image.png"
navLinks:
  - href: "#games"
    label: "Games Industry"
  - href: "#utilities"
    label: "Utilities"
  - href: "#apps"
    label: "Apps & Services"
bodyClass: ""
---
<div class="page-top index">
    {% include "nav.njk" %}
</div>
<div class="splash-bg index">
    <center>
        <div class="about" id="about">
            <div class="me">
                <img src="images/me2.png" alt="me">
            </div>
            <div class="desc">
                <h1 class="title" style="margin-bottom:0;">I'm Jess Rappaport,
                <div>
                    <img class="inline-emoji flag" src="images/trans-flag-emoji.png" alt="Trans pride flag"> proud UI/UX designer and illustrator.
                </div>
                </h1>
                <p>I've been creating apps, services, and communities since 2002. I also make little 4-panel comics about my life!</p>
            </div>
        </div>
    </center>
    <div class="segmented-control" id="segmented-control">
        <a href="#games">
            <center>
                    <i class="fa-solid fa-gamepad"></i>
                Games Industry
            </center>
        </a>
        <a href="#utilities">
            <center>
                <i class="fa-solid fa-screwdriver-wrench"></i>
                Utilities
            </center>
        </a>
        <a href="#apps">
            <center>
                    <svg viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg" style="width:26px;height:26px;display:block;margin:0 auto 8px;">
                        <rect x="4" y="4" width="14" height="14" rx="2" ry="2" fill="currentColor"></rect>
                        <rect x="23" y="1" width="14" height="14" rx="2" ry="2" fill="currentColor" transform="rotate(17 30 8)"></rect>
                        <rect x="4" y="21" width="14" height="14" rx="2" ry="2" fill="currentColor"></rect>
                        <rect x="21" y="21" width="14" height="14" rx="2" ry="2" fill="currentColor"></rect>
                    </svg>
                Apps &amp; Services
            </center>
        </a>
    </div>
</div>
{% set latestComic = comics[comics.length - 1] %}
{% set firstComic = comics[0] %}
{% if comics.length > 1 %}
    {% set prevComic = comics[comics.length - 2] %}
{% endif %}
<div class="content index page" id="comic-title">
    <h1 id="comics" class="title" style="text-align:center;margin:0;text-transform:none;">Latest Comic</h1>
</div>
<div class="content index page" id="comic-title">
    <h2 class="title" style="text-align:center;margin:0;text-transform:none;">#{{ latestComic.number }} - {{ latestComic.title }}</h2>
</div>
<div class="content page" style="text-align:center;">
    <a href="/comics/">
        <img src="{{ latestComic.image }}" alt="{{ latestComic.alt }}"{% if latestComic.titleText %} title="{{ latestComic.titleText }}"{% endif %} class="comic-img">
    </a>
    <div class="segmented-control">
        <a{% if latestComic.slug == firstComic.slug %} disabled{% else %} href="/comics/{{ firstComic.slug }}/" onclick="if(typeof gtag!=='undefined')gtag('event','comic_navigation',{'event_category':'engagement','event_label':'first'})"{% endif %}>
            <center>
                <i class="fa-solid fa-fast-backward"></i>
                First
            </center>
        </a>
        <a{% if prevComic %} href="/comics/{{ prevComic.slug }}/" onclick="if(typeof gtag!=='undefined')gtag('event','comic_navigation',{'event_category':'engagement','event_label':'previous'})"{% else %} disabled{% endif %}>
            <center>
                <i class="fa-solid fa-backward"></i>
                Previous
            </center>
        </a>
        <a href="/comics/all/" onclick="if(typeof gtag!=='undefined')gtag('event','comic_navigation',{'event_category':'engagement','event_label':'view_all'})">
            <center>
                <svg viewBox="0 0 30 30" xmlns="http://www.w3.org/2000/svg" style="width: 26px; height: 26px; display: block; margin: 0 auto 8px;">
                    <rect x="2" y="2" width="7" height="7" rx="1.5" ry="1.5" fill="currentColor"/>
                    <rect x="11" y="2" width="7" height="7" rx="1.5" ry="1.5" fill="currentColor"/>
                    <rect x="20" y="2" width="7" height="7" rx="1.5" ry="1.5" fill="currentColor"/>
                    <rect x="2" y="11" width="7" height="7" rx="1.5" ry="1.5" fill="currentColor"/>
                    <rect x="11" y="11" width="7" height="7" rx="1.5" ry="1.5" fill="currentColor"/>
                    <rect x="20" y="11" width="7" height="7" rx="1.5" ry="1.5" fill="currentColor"/>
                    <rect x="2" y="20" width="7" height="7" rx="1.5" ry="1.5" fill="currentColor"/>
                    <rect x="11" y="20" width="7" height="7" rx="1.5" ry="1.5" fill="currentColor"/>
                    <rect x="20" y="20" width="7" height="7" rx="1.5" ry="1.5" fill="currentColor"/>
                </svg>
                View All
            </center>
        </a>
        <a id="copyBtn" onclick="copyComicLink()" style="cursor:pointer;">
            <center>
                <i class="fa-solid fa-link"></i>
                Copy Link
            </center>
        </a>
    </div>
    <div class="segmented-control">
        <button id="notifyLatest" class="toggle-switch">
            <i class="fa-regular fa-bell"></i>
            <span>Get notified about new comics</span>
            <div class="switch-toggle" onclick="requestNotifications('notifyLatest'); event.stopPropagation();">
                <div class="switch-circle"></div>
            </div>
        </button>
    </div>
</div>
<div class="content index page" id="section-4">
    <h1 id="games" class="title" style="padding-left:32px;padding-top:32px;margin:0;">Games Industry</h1>
</div>
<div class="content index page" id="section-5">
    <div class="item-wrapper">
        <div class="item item-transition">
            <a class="item-content zelda-universe" href="/zelda-universe/">
                <div class="site-logo"></div>
                <span class="subtitle">The world's largest <i>Legend of Zelda</i> fan community.</span>
            </a>
        </div>
    </div>
    <div class="item-wrapper">
        <div class="item item-transition">
            <a class="item-content zelda-maps" href="/zelda-maps/">
                <div class="site-logo"></div>
                <span>Comprehensive maps for <i>Breath of the Wild</i> and more.</span>
            </a>
        </div>
    </div>
    <div class="item-wrapper">
        <div class="item item-transition">
            <a class="item-content zelda-wiki" href="/zelda-wiki/">
                <div class="site-logo"></div>
                <span>The definitive <i>Zelda</i> encyclopedia.</span>
            </a>
        </div>
    </div>
    <div class="item-wrapper">
        <div class="item item-transition">
            <a class="item-content master-sword" href="https://zeldauniverse.net/features/making-the-master-sword/" target="_blank">
                <span>MAKING <b>THE</b> MASTER SWORD</span>
            </a>
        </div>
    </div>
</div>
<div class="content index page" id="section-1">
    <h1 id="utilities" class="title" style="padding-left:32px;margin-top:32px;margin-bottom:0;">Utilities</h1>
</div>
<div class="content index page" style="padding-bottom:24px;" id="section-2">
    <div class="item-wrapper">
        <div class="item item-transition">
            <a class="item-content goldenchaos-btt" href="/goldenchaos-btt/"></a>
        </div>
    </div>
    <div class="item-wrapper">
        <div class="item item-transition">
            <a class="item-content faceports" href="/faceports/">
                <span></span>
            </a>
        </div>
    </div>
</div>
<div class="content index page" id="section-3">
    <h1 id="apps" class="title" style="padding-left:32px;margin:0;">Apps and Services</h1>
</div>
<div class="content index page" style="padding-bottom:32px;">
    <div class="item-wrapper">
        <div class="item item-transition">
            <a class="item-content collx" href="/collx/"></a>
        </div>
    </div>
    <div class="item-wrapper">
        <div class="item item-transition">
            <a class="item-content crossbeam" href="/crossbeam/"></a>
        </div>
    </div>
    <div class="item-wrapper">
        <div class="item item-transition">
            <a class="item-content squareknot" href="/squareknot/">
                <span>Beautiful, branching step-by-step guides.</span>
            </a>
        </div>
    </div>
    <div class="item-wrapper">
        <div class="item item-transition">
            <a class="item-content goodsemester" href="/goodsemester/">
                <span>Revolutionary online learning platform.</span>
            </a>
        </div>
    </div>
</div>
<div class="content index page" id="section-6">
    <h1 id="misc" class="title" style="padding-left:32px;margin:0;">Misc</h1>
</div>
<div class="content index page" style="padding-bottom:32px;">
    <div class="item-wrapper">
        <div class="item item-transition">
            <a class="item-content zodttd-icons" href="/emulator-icons/">
                <span>iOS Emulator Icons</span>
            </a>
        </div>
    </div>
    <div class="item-wrapper placeholder">
        <div class="item item-transition">
            <div class="item-content" aria-hidden="true"></div>
        </div>
    </div>
</div>
<footer>
    <span>&copy; 2004-<script>document.write(new Date().getFullYear())</script> Jess Rappaport</span>
</footer>

<script>
async function copyWithFallback(text) {
    try {
        await navigator.clipboard.writeText(text);
        return true;
    } catch (err) {
        const textarea = document.createElement('textarea');
        textarea.value = text;
        textarea.style.position = 'fixed';
        textarea.style.opacity = '0';
        document.body.appendChild(textarea);
        textarea.focus();
        textarea.select();
        let ok = false;
        try {
            ok = document.execCommand('copy');
        } catch (copyErr) {
            console.error('Copy failed', copyErr);
        }
        document.body.removeChild(textarea);
        return ok;
    }
}

function showCopied(buttonId, success) {
    const btn = document.getElementById(buttonId);
    if (!btn) return;
    const originalHTML = btn.innerHTML;
    btn.innerHTML = success ? '<center><i class="fa-solid fa-check"></i>Copied!</center>' : '<center><i class="fa-solid fa-xmark"></i>Copy failed</center>';
    setTimeout(() => {
        btn.innerHTML = originalHTML;
    }, 2000);
}

async function copyComicLink() {
    const link = window.location.origin + '/comics/{{ latestComic.slug }}/';
    const ok = await copyWithFallback(link);
    showCopied('copyBtn', ok);
    if (ok && typeof gtag !== 'undefined') {
        gtag('event', 'copy_link', {
            'event_category': 'engagement',
            'event_label': 'comic_link'
        });
    }
}

function updateBellIcon(buttonId, isSubscribed) {
  const btn = document.getElementById(buttonId);
  if (!btn) return;
  const bellClass = isSubscribed ? 'fa-solid' : 'fa-regular';
  const icon = btn.querySelector('i');
  if (icon) {
    icon.className = bellClass + ' fa-bell';
  }
  btn.classList.toggle('active', isSubscribed);
}

async function checkNotificationStatus(buttonId) {
  if (!window.OneSignalDeferred) return;
  OneSignalDeferred.push(async function(OneSignal) {
    const permission = await OneSignal.Notifications.permission;
    updateBellIcon(buttonId, permission);
  });
}

async function requestNotifications(buttonId) {
  console.log('requestNotifications called, buttonId:', buttonId);
  const btn = document.getElementById(buttonId);
  if (!btn) {
    console.error('Button not found:', buttonId);
    return;
  }
  console.log('Button found, checking OneSignalDeferred:', window.OneSignalDeferred);
  if (!window.OneSignalDeferred) {
    console.error('OneSignalDeferred not available');
    alert('Push notifications are not available.');
    return;
  }
  
  // Optimistically toggle the switch immediately
  const wasActive = btn.classList.contains('active');
  updateBellIcon(buttonId, !wasActive);
  
  btn.disabled = true;
  console.log('Pushing to OneSignalDeferred...');
  OneSignalDeferred.push(async function(OneSignal) {
    console.log('Inside OneSignalDeferred, OneSignal:', OneSignal);
    try {
      // Check browser native permission state
      const browserPermission = Notification.permission;
      console.log('Browser native permission:', browserPermission);
      
      const permission = await OneSignal.Notifications.permission;
      console.log('Current permission:', permission);
      
      // If already subscribed and toggle was active, unsubscribe
      if (permission && wasActive) {
        console.log('Unsubscribing...');
        await OneSignal.User.PushSubscription.optOut();
        console.log('Unsubscribed successfully');
        updateBellIcon(buttonId, false);
        btn.disabled = false;
        return;
      }
      
      // If already subscribed but toggle was inactive, just update UI
      if (permission) {
        console.log('Already subscribed');
        btn.disabled = false;
        return;
      }
      
      // If browser permission is denied, show message
      if (browserPermission === 'denied') {
        console.error('Browser permission is denied - user must enable in browser settings');
        alert('Push notifications are blocked. Please enable them in your browser settings.');
        updateBellIcon(buttonId, wasActive); // Revert toggle
        btn.disabled = false;
        return;
      }
      
      console.log('Calling promptPush...');
      
      // Try the native OneSignal method for v16
      try {
        await OneSignal.User.PushSubscription.optIn();
        console.log('optIn() succeeded');
      } catch (optInError) {
        console.error('optIn() failed, trying Slidedown:', optInError);
        await OneSignal.Slidedown.promptPush();
      }
      
      console.log('Prompt completed');
      
      // Check if permission was actually granted
      const newPermission = Notification.permission;
      console.log('Permission after prompt:', newPermission);
      
      if (newPermission === 'granted') {
        console.log('Permission granted!');
        
        // Wait for OneSignal to sync the subscription to their servers
        await new Promise(resolve => setTimeout(resolve, 1500));
        console.log('Waited for subscription sync');
        
        // Check if subscription is actually registered with OneSignal
        const isPushSubscribed = await OneSignal.User.PushSubscription.isPushSubscriptionEnabled();
        console.log('isPushSubscriptionEnabled:', isPushSubscribed);
        
        if (isPushSubscribed) {
          console.log('Subscription verified with OneSignal!');
          updateBellIcon(buttonId, true);
          // Track subscription in Google Analytics
          if (typeof gtag !== 'undefined') {
            gtag('event', 'notification_subscribe', {
              'event_category': 'engagement',
              'event_label': 'comic_notifications'
            });
          }
        } else {
          console.warn('Permission granted but subscription not verified with OneSignal');
          alert('Permission granted, but subscription sync failed. Please try again.');
          updateBellIcon(buttonId, wasActive); // Revert toggle
        }
      } else if (newPermission === 'denied') {
        console.warn('Permission denied');
        alert('You denied push notification permission.');
        updateBellIcon(buttonId, wasActive); // Revert toggle
      } else {
        console.warn('Permission state:', newPermission);
        updateBellIcon(buttonId, wasActive); // Revert toggle
      }
      btn.disabled = false;
    } catch (error) {
      console.error('Notification request error:', error);
      alert('Subscription failed. Please try again.');
      updateBellIcon(buttonId, wasActive); // Revert toggle
      btn.disabled = false;
    }
  });
}

if (window.OneSignalDeferred) {
  console.log('OneSignalDeferred detected, checking notification status');
  OneSignalDeferred.push(async function(OneSignal) {
    console.log('OneSignal loaded:', OneSignal);
    checkNotificationStatus('notifyLatest');
  });
} else {
  console.warn('OneSignalDeferred not found on page load');
}
</script>
